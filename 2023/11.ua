Empty ← ↧⊃(=0⊢|≍↻1.)
PartOne ← (
  ⍥(⍉▽+1≡Empty.)2
  ÷2/+♭⊠(+⊃(⌵-⊙⋅∘|⌵-⋅⊙⋅∘)∩°⊟).⊚
)
Extra ← -:×1000000./+↧⊃(<⋅⊙∘|>⊙⋅∘)⊃↧↥
PartTwo ← (
  ⊙(∩¤)⍥(⍉:⊚≡Empty.)2
  ⊠(
    ∩°⊟
    +++⊃(⌵-⊙⋅∘|⌵-⋅⊙⋅∘|∩Extra⊃(⊙⋅⊙⋅⋅∘|⋅⊙⋅⊙∘))
  ).⊚
  ÷2/+♭
)
&fras "input.txt"
=@#⊜∘≠@\n.
⊃PartOne PartTwo
